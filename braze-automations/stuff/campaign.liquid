{% connected_content https://www.stuff.co.nz/api/v1.0/stuff/page?path=home :save topstory :cache_max_age 300 %} {% if topstory == Nil %} {% abort_message() %} {% endif %} {%- assign defcon_on = false -%} {%- for frame in topstory.page.frames -%} {%- if frame.moduleTitle == "Defcon" -%} {%- assign defcon_on = true -%} {%- endif -%} {%- endfor -%} {% assign top-stories_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.moduleTitle == "Defcon" %}{% assign defcon_position = forloop.index0 %}{% endif %}{% endfor %} {% assign top-stories_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.moduleTitle == "Stuff homepage top stories" %}{% assign top-stories_position = forloop.index0 %}{% endif %}{% endfor %} {% assign editors-pick_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "Editors' picks" %}{% assign editors-pick_position = forloop.index0 %}{% endif %}{% endfor %} {% assign nz-news_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "NZ news" %}{% assign nz-news_position = forloop.index0 %}{% endif %}{% endfor %} {% assign sport_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "Sport" %}{% assign sport_position = forloop.index0 %}{% endif %}{% endfor %} {% assign world-news_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "World news" %}{% assign world-news_position = forloop.index0 %}{% endif %}{% endfor %} {% assign entertainment_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "Entertainment" %}{% assign entertainment_position = forloop.index0 %}{% endif %}{% endfor %} {% assign travel_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.title == "Travel" %}{% assign travel_position = forloop.index0 %}{% endif %}{% endfor %} {% assign homed_position = 0 %}{% for frame in topstory.page.frames %}{% if frame.moduleTitle == "Homed" %}{% assign homed_position = forloop.index0 %}{% endif %}{% endfor %}